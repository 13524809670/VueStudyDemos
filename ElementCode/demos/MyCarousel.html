<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>select</title>

    <style>
        #container {
            position: relative;
            overflow: hidden;
        }

        .block {
            position: absolute;
            display: inline-block;
            width: 100%;
            height: 100%;
        }

        .block-01 {
            background-color: #99a9bf;
        }

        .block-02 {
            background-color: #d3dce6;
        }

        h1 {
            position: absolute;
            top: 50%;
            width: 100%;
            text-align: center;
            transform: translateY(-50%);
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>
    <div id="app">
        <div id="container">
            <div class="block block-01">
                <h1>1</h1>
            </div>
            <div class="block block-02">
                <h1>2</h1>
            </div>
            <div class="block block-01">
                <h1>3</h1>
            </div>
            <div class="block block-02">
                <h1>4</h1>
            </div>
        </div>

        <button id="btnPrev">prev</button>
        <button id="btnNext">next</button>
    </div>
    <script>
        var config = {
            height: "300px",
            index: 0,
        }

        var container = document.getElementById("container")
        container.style.height = config.height

        function getOffSet() {
            var blocks = document.getElementsByClassName("block")
            var offsetWidth = document.getElementById("container").offsetWidth
            for (let index = 0, len = blocks.length; index < len; index++) {

                var curIndex = index
                if (curIndex != config.index) {
                    curIndex = processIndex(curIndex, config.index, blocks.length)
                }
                let translate = offsetWidth * (curIndex - config.index)

                var s = blocks[index].style
                s.transition = ``
                s.transform = s.msTransform = s.webkitTransform = `translateX(${translate}px)`

                if (config.index == 0) {
                    blocks[config.index].style.transition = `all 1s`
                    blocks[blocks.length - 1].style.transition = `all 1s`
                    blocks[config.index + 1].style.transition = `all 1s`
                } else if (config.index == blocks.length - 1) {
                    blocks[config.index].style.transition = `all 1s`
                    blocks[config.index - 1].style.transition = `all 1s`
                    blocks[config.index + 1].style.transition = `all 1s`
                } else {
                    if (index == config.index) {
                        blocks[config.index].style.transition = `all 1s`
                        blocks[config.index - 1].style.transition = `all 1s`
                        blocks[config.index + 1].style.transition = `all 1s`
                    }
                }
            }
        }

        function processIndex(index, activeIndex, length) {
            if (activeIndex === 0 && index === length - 1) {
                return -1;
            } else if (activeIndex === length - 1 && index === 0) {
                return length;
            } else if (index < activeIndex - 1 && activeIndex - index >= length / 2) {
                return length + 1;
            } else if (index > activeIndex + 1 && index - activeIndex >= length / 2) {
                return -2;
            }
            return index;
        }

        // 计算卡片化中组件的位置
        function calculateTranslate(index, activeIndex, parentWidth) {
            if (this.inStage) {
                // 其他卡片
                return parentWidth * ((2 - CARD_SCALE) * (index - activeIndex) + 1) / 4;
            } else if (index < activeIndex) {
                // 左边卡片
                return -(1 + CARD_SCALE) * parentWidth / 4;
            } else {
                // 右边卡片
                return (3 + CARD_SCALE) * parentWidth / 4;
            }
        }

        getOffSet()

        var blockLength = document.getElementsByClassName("block").length

        function prev() {
            pauseTimer()
            if (config.index > 0) {
                config.index--
            } else {
                config.index = blockLength - 1
            }
            getOffSet()
            startTimer()
        }

        function next() {
            pauseTimer()
            if (config.index < blockLength - 1) {
                config.index++
            } else {
                config.index = 0
            }
            getOffSet()
            startTimer()
        }

        document.getElementById("btnPrev").onclick = prev
        document.getElementById("btnNext").onclick = next

        var timer = null

        function pauseTimer() {
            if (timer) {
                clearInterval(timer)
            }
        }

        function startTimer() {
            timer = setInterval(next, 3000)
        }

        startTimer()
    </script>
</body>

</html>